<html>
    <title>Kontakt Sensor</title>
    <body>
        <div class="control-container" style="">
            <input id="contact" class="control-panel" style="" type="button" value="LADEN .." id="switch">
        </div>
        <h1>Laden ..</h1>
        <div class="main" style="margin-top: 100px; margin-bottom: 132px; display: table">
            <p><b>MAC: </b>Laden ..</p>
            <p><b>IP: </b>Laden ..</p>
            <p><b>Typ: </b>Laden ..</p>
            <p><b>Version: </b>Laden ..</p>
            <p><b>LED: </b>Laden ..</p>
        </div>
        <div class="main">
            <input id="restart-btn" style="margin-bottom: 20px;" type="button" value="Gerät Neustarten" onclick="restartDevice()">
            <div style="display: flex">
                <input style="" type="button" value="Zurück" onclick="window.location.href='http://syntex.local:1711/'">
                <input style="margin-left: 20px;" type="button" value="Einstellungen" onclick="openSettings()">
            </div>
        </div>
    </body>
</html>
<script>

    var device = JSON.parse('<%device%>');
        
    console.log(device);
    
    document.getElementsByTagName('h1')[0].innerHTML = device.name;
    
    document.getElementsByClassName('main')[0].children[0].innerHTML = '<b>MAC: </b>' + device.id;
    document.getElementsByClassName('main')[0].children[1].innerHTML = '<b>IP: </b>' + device.ip;
    document.getElementsByClassName('main')[0].children[2].innerHTML = '<b>Typ: </b>' + device.type;
    document.getElementsByClassName('main')[0].children[3].innerHTML = '<b>Version: </b>' + device.version;
    document.getElementsByClassName('main')[0].children[4].innerHTML = '<b>LED: </b>' + device.led;
    
    document.getElementsByClassName('main')[1].setAttribute('type', device.type);
    document.getElementsByClassName('main')[1].setAttribute('version', device.version);
    
    function openSettings()
    {
        
    }
    
    function fetchState()
    {        
        var client = new XMLHttpRequest();
        
        client.open('GET', 'http://syntex.local:1710/devices?mac=' + device.id);

        client.onreadystatechange = function()
        {
            if(client.readyState === 4)
            {  
                if(client.status === 200)
                {
                    if(client.responseText == true)
                    {
                        document.getElementById('contact').value = 'ZU';
                        document.getElementById('contact').style.backgroundImage = 'linear-gradient(to top, hsl(150, 75%, 45%) 0%, hsl(150, 75%, 55%) 100%)';
                    }
                    else if(client.responseText == false)
                    {
                        document.getElementById('contact').value = 'GEÖFFNET';
                        document.getElementById('contact').style.backgroundImage = 'linear-gradient(to top, hsl(350, 75%, 45%) 0%, hsl(350, 75%, 55%) 100%)';
                    }
                    console.log(client.responseText);
                }
            }
        }
    }

</script>
<html>
    <title></title>
    <body>
        <h1>Einstellungen</h1>
        <p>( <?php echo $result[0]['name']; ?> )</p>
        <div class="main" style="margin-top: 100px; margin-bottom: 132px; display: table;" mac="<?php echo $result[0]['mac']; ?>" ip="<?php echo $result[0]['ip']; ?>" type="<?php echo $result[0]['type']; ?>">
            <p>Name: <input name="sensorname" type="text" style="max-width: 325px" value="<?php echo $result[0]['name']; ?>"></p>
            <p>LED: <input name="led" type="text" style="max-width: 150px" value="<?php echo $result[0]['led']; ?>"></p>
        </div>
        <div class="main" style="">
            <input id="reset-btn" style="margin-bottom: 20px;" type="button" value="Gerät Zurücksetzen" onclick="resetDevice()">
            <input style="margin-bottom: 20px;" type="button" value="Gerät Neu Verbinden" onclick="window.location.href='http://syntex.local/reconnect.php?ip=<?php echo $result[0]['ip']; ?>'">
            <div style="display: flex">
                <input style="" type="button" value="Zurück" onclick="window.location.href='http://syntex.local/devices/contact-sensor.php?mac=<?php echo $_GET['mac']; ?>'">
                <input id="savebtn" style="margin-left: 20px;" type="button" value="Speichern" onclick="saveConfig()">
            </div>
        </div>
    </body>
</html>
<?php require('../includes/devices-settings.php'); ?>
